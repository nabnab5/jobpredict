<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard - Matching Emploi</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{
      --bg: #f8fafc; --card: #ffffff; --muted: #64748b; --accent: #3b82f6; --danger: #ef4444;
      --text-primary: #1e293b; --text-secondary: #475569; --border: #e2e8f0;
      --hover-bg: #f1f5f9; --sidebar-bg: #ffffff; --header-bg: #ffffff;
      --success: #10b981; --warning: #f59e0b; --gradient: linear-gradient(135deg, #3b82f6, #1d4ed8);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --icon-color: #3b82f6;
    }
    [data-theme="dark"]{ 
      --bg: #0f172a; --card: #1e293b; --muted: #94a3b8; --accent: #60a5fa; --danger: #f87171;
      --text-primary: #f1f5f9; --text-secondary: #cbd5e1; --border: #334155;
      --hover-bg: #1e293b; --sidebar-bg: #0f172a; --header-bg: #1e293b;
      --gradient: linear-gradient(135deg, #60a5fa, #3b82f6);
      --icon-color: #60a5fa;
    }
    *{box-sizing:border-box}
    body{font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;margin:0;background:var(--bg);color:var(--text-primary);transition:all 0.3s ease}
    .app{display:grid;grid-template-columns:280px 1fr;min-height:100vh}
    .sidebar{background:var(--sidebar-bg);padding:24px;border-right:1px solid var(--border);position:sticky;top:0;height:100vh;overflow-y:auto}
    .logo{font-weight:800;margin-bottom:32px;font-size:22px;color:var(--accent);display:flex;align-items:center;gap:12px;padding:8px 0}
    .logo:before{content:"";display:block;width:32px;height:32px;background:var(--gradient);border-radius:8px}
    .nav{display:flex;flex-direction:column;gap:8px}
    .nav button{background:transparent;border:0;padding:14px 16px;border-radius:12px;text-align:left;cursor:pointer;color:var(--text-secondary);transition:all 0.2s;display:flex;align-items:center;gap:14px;font-size:15px;font-weight:500;position:relative;overflow:hidden}
    .nav button:hover{background:var(--hover-bg);color:var(--text-primary);transform:translateX(4px)}
    .nav button.active{background:var(--accent);color:white;box-shadow:var(--shadow)}
    .nav button.active:before{content:"";position:absolute;left:0;top:0;height:100%;width:4px;background:var(--accent)}
    .nav button.active .nav-icon{filter: brightness(0) invert(1);}
    .nav-icon{width:20px;height:20px;color:var(--icon-color);transition:all 0.2s}
    .nav button:hover .nav-icon{color:var(--accent)}
    .nav button.active .nav-icon{color:white}
    header{display:flex;justify-content:space-between;align-items:center;padding:20px 32px;background:var(--header-bg);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10;box-shadow:0 1px 3px rgba(0,0,0,0.05)}
    .main{padding:32px;background:var(--bg)}
    .topcards{display:grid;grid-template-columns:repeat(auto-fill, minmax(240px, 1fr));gap:20px;margin-bottom:32px}
    .card{background:var(--card);padding:24px;border-radius:16px;box-shadow:var(--shadow);border:1px solid var(--border);transition:all 0.3s ease;position:relative;overflow:hidden}
    .card:before{content:"";position:absolute;top:0;left:0;width:100%;height:4px;background:var(--gradient)}
    .card:hover{transform:translateY(-5px);box-shadow:var(--shadow-lg)}
    .card h3{margin:12px 0 0;font-size:32px;font-weight:700;color:var(--text-primary)}
    .table{width:100%;border-collapse:collapse;background:var(--card);border-radius:16px;overflow:hidden;box-shadow:var(--shadow);border:1px solid var(--border)}
    table td,table th{padding:16px 20px;border-bottom:1px solid var(--border)}
    table th{background:var(--hover-bg);text-align:left;font-weight:600;color:var(--text-primary);font-size:14px;text-transform:uppercase;letter-spacing:0.5px}
    table tr:last-child td{border-bottom:none}
    table tr:hover td{background:var(--hover-bg)}
    .controls{display:flex;gap:16px;align-items:center}
    .btn{padding:12px 20px;border-radius:12px;border:0;cursor:pointer;font-weight:600;font-size:14px;transition:all 0.2s;display:inline-flex;align-items:center;gap:8px}
    .btn.primary{background:var(--gradient);color:#fff;box-shadow:var(--shadow)}
    .btn.primary:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    .btn.warn{background:var(--warning);color:#000}
    .btn.danger{background:var(--danger);color:#fff}
    .btn.danger:hover{background:#dc2626;box-shadow:0 2px 4px rgba(239,68,68,0.3)}
    .btn.secondary{background:var(--hover-bg);color:var(--text-primary);border:1px solid var(--border)}
    .btn.secondary:hover{background:var(--border);transform:translateY(-1px)}
    .small{font-size:14px;color:var(--text-secondary);font-weight:500}
    .flex{display:flex;gap:16px;align-items:center}
    .panel{margin-top:24px}
    .search-container{position:relative}
    .search{padding:12px 20px 12px 44px;border-radius:12px;border:1px solid var(--border);background:var(--card);width:320px;font-size:14px;transition:all 0.2s;box-shadow:var(--shadow)}
    .search:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(59,130,246,0.1)}
    .search-icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:var(--muted)}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:1000;backdrop-filter:blur(4px)}
    .modal{background:var(--card);padding:32px;border-radius:20px;max-width:760px;width:94%;max-height:80vh;overflow:auto;box-shadow:var(--shadow-lg);border:1px solid var(--border);animation:modalAppear 0.3s ease}
    @keyframes modalAppear{from{opacity:0;transform:scale(0.9)} to{opacity:1;transform:scale(1)}}
    .badge{padding:8px 14px;border-radius:20px;font-size:12px;font-weight:600;display:inline-flex;align-items:center;gap:6px}
    .badge.accept{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}
    .badge.pending{background:#fef3c7;color:#92400e;border:1px solid #fcd34d}
    .badge.published{background:#dbeafe;color:#1e40af;border:1px solid#93c5fd}
    .tag{padding:6px 12px;background:var(--hover-bg);border-radius:20px;font-size:12px;color:var(--text-secondary);display:inline-block;margin:4px 4px 4px 0;font-weight:500}
    .section-title{font-size:24px;font-weight:700;margin:0 0 20px;color:var(--text-primary);position:relative;padding-bottom:12px}
    .section-title:after{content:"";position:absolute;bottom:0;left:0;width:60px;height:4px;background:var(--gradient);border-radius:2px}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(320px, 1fr));gap:24px;margin-top:24px}
    .stat-card{background:var(--card);padding:24px;border-radius:16px;border:1px solid var(--border);display:flex;align-items:center;gap:20px;box-shadow:var(--shadow);transition:all 0.3s}
    .stat-card:hover{transform:translateY(-3px);box-shadow:var(--shadow-lg)}
    .stat-icon{width:60px;height:60px;border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:24px;background:var(--gradient);color:white}
    .stat-content{flex:1}
    .stat-value{font-size:28px;font-weight:700;margin:4px 0;color:var(--accent)}
    .stat-label{font-size:14px;color:var(--text-secondary);font-weight:600}
    .action-buttons{display:flex;gap:10px;flex-wrap:wrap}
    .trend{display:flex;align-items:center;gap:4px;font-size:13px;margin-top:6px}
    .trend.up{color:var(--success)}
    .trend.down{color:var(--danger)}
    .profile-avatar{width:48px;height:48px;border-radius:50%;background:var(--gradient);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:18px}
    .activity-item{display:flex;gap:16px;padding:16px 0;border-bottom:1px solid var(--border)}
    .activity-item:last-child{border-bottom:none}
    .activity-icon{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;background:var(--hover-bg);color:var(--accent)}
    .activity-content{flex:1}
    .activity-title{font-weight:600;margin-bottom:4px}
    .activity-meta{font-size:13px;color:var(--text-secondary)}
    
    /* Styles pour les diagrammes */
    .charts-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 25px;
        margin-bottom: 30px;
    }
    
    .chart-card {
        background: var(--card);
        border-radius: 12px;
        padding: 20px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
    }
    
    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .chart-header h3 {
        font-size: 18px;
        margin: 0;
    }
    
    .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
    }
    
    .status-cards {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
    }
    
    .status-card {
        background: var(--card);
        border-radius: 12px;
        padding: 20px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
    }
    
    .status-card h3 {
        font-size: 16px;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .progress-bar {
        height: 8px;
        background-color: var(--border);
        border-radius: 4px;
        margin: 15px 0;
        overflow: hidden;
    }
    
    .progress {
        height: 100%;
        border-radius: 4px;
    }
    
    .progress-1 {
        width: 75%;
        background: var(--gradient);
    }
    
    .progress-2 {
        width: 60%;
        background: linear-gradient(90deg, #00b894, #55efc4);
    }
    
    .progress-3 {
        width: 85%;
        background: linear-gradient(90deg, #fd79a8, #ff9ff3);
    }
    
    .percentage {
        font-size: 24px;
        font-weight: bold;
        margin: 10px 0;
    }
    
    .charts-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:24px;margin-top:24px}
    .chart-title{font-size:16px;font-weight:600;margin-bottom:16px;color:var(--text-primary)}
    
    @media (max-width:1024px){.app{grid-template-columns:1fr} .sidebar{display:none} .topcards{grid-template-columns:1fr 1fr} .search{width:100%}}
    @media (max-width:768px){.topcards{grid-template-columns:1fr} .stats-grid{grid-template-columns:1fr} .action-buttons{flex-direction:column} .search{width:100%} .charts-grid{grid-template-columns:1fr} .charts-container{grid-template-columns:1fr} .status-cards{grid-template-columns:1fr}}
    
    /* Ic√¥nes SVG personnalis√©es */
    .icon-dashboard, .icon-users, .icon-offers, .icon-analytics, .icon-theme, .icon-search, 
    .icon-add, .icon-view, .icon-delete, .icon-candidate, .icon-company, .icon-offer, .icon-match {
      width: 20px;
      height: 20px;
      color: var(--icon-color);
    }
    
    .nav button.active .icon-dashboard, 
    .nav button.active .icon-users, 
    .nav button.active .icon-offers, 
    .nav button.active .icon-analytics {
      color: white;
    }
  </style>
</head>
<body>
  <div class="app" id="app" data-theme="light">
    <aside class="sidebar">
      <div class="logo">MatchWork Admin</div>
      <nav class="nav">
        <button class="active" onclick="showPanel('dashboard')">
          <svg class="nav-icon icon-dashboard" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          Dashboard
        </button>
        <button onclick="showPanel('users')">
          <svg class="nav-icon icon-users" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          Utilisateurs
        </button>
        <button onclick="showPanel('offers')">
          <svg class="nav-icon icon-offers" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h6"></path>
            <polyline points="16,2 22,2 22,8"></polyline>
            <line x1="10" y1="14" x2="21" y2="3"></line>
          </svg>
          Offres
        </button>
        <button onclick="showPanel('analytics')">
          <svg class="nav-icon icon-analytics" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="20" x2="18" y2="10"></line>
            <line x1="12" y1="20" x2="12" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="14"></line>
          </svg>
          Analytics
        </button>
        <hr style="border:none;height:1px;background:var(--border);margin:24px 0"/>
        <div class="small" style="padding:0 16px">Pr√©f√©rences</div>
        <button class="btn secondary" onclick="toggleTheme()" style="margin-top:12px">
          <svg class="icon-theme" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          Basculer th√®me
        </button>
      </nav>
    </aside>

    <main class="main">
      <header>
        <div class="flex">
          <h2 id="panelTitle" style="margin:0;font-weight:700;font-size:28px">Dashboard</h2>
        </div>
        <div class="controls">
          <div class="search-container">
            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <input class="search" id="globalSearch" placeholder="Recherche..." oninput="renderCurrent()"/>
          </div>
        </div>
      </header>

      <section id="content">
        <div id="panel-dashboard" class="panel">
          <div class="topcards">
            <div class="card">
              <div class="small">Candidats inscrits</div>
              <h3 id="countCandidates">0</h3>
              <div class="trend up">‚Üë +12% ce mois</div>
            </div>
            <div class="card">
              <div class="small">Entreprises partenaires</div>
              <h3 id="countCompanies">0</h3>
              <div class="trend up">‚Üë +5% ce mois</div>
            </div>
            <div class="card">
              <div class="small">Offres actives</div>
              <h3 id="countOffers">0</h3>
              <div class="trend up">‚Üë +8% ce mois</div>
            </div>
            <div class="card">
              <div class="small">Taux de matching</div>
              <h3 id="matchRate">0%</h3>
              <div class="trend up">‚Üë +3% ce mois</div>
            </div>
          </div>
          
          <div class="charts-container">
            <div class="chart-card">
              <div class="chart-header">
                <h3>R√©partition des Utilisateurs</h3>
              </div>
              <div class="chart-container">
                <canvas id="userDistributionChart"></canvas>
              </div>
            </div>
            
            <div class="chart-card">
              <div class="chart-header">
                <h3>Activit√© Mensuelle</h3>
              </div>
              <div class="chart-container">
                <canvas id="monthlyActivityChart"></canvas>
              </div>
            </div>
          </div>
          
          <div class="status-cards">
            <div class="status-card">
              <h3><i>üìä</i> √âvolution des Matchings</h3>
              <div class="progress-bar">
                <div class="progress progress-1"></div>
              </div>
              <div class="percentage">75%</div>
              <div class="trend up">‚Üë 12% ce mois</div>
            </div>
            
            <div class="status-card">
              <h3><i>üîç</i> Recherche...</h3>
              <div class="progress-bar">
                <div class="progress progress-2"></div>
              </div>
              <div class="percentage">60%</div>
              <div class="trend up">‚Üë 5% cette semaine</div>
            </div>
            
            <div class="status-card">
              <h3><i>‚úÖ</i> Taux de matching (%)</h3>
              <div class="progress-bar">
                <div class="progress progress-3"></div>
              </div>
              <div class="percentage">85%</div>
              <div class="trend up">‚Üë 8% ce mois</div>
            </div>
          </div>
          
          <div class="card" style="margin-top: 30px;">
            <div class="section-title">Activit√© r√©cente</div>
            <div class="activity-list">
              <div class="activity-item">
                <div class="activity-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10,9 9,9 8,9"></polyline>
                  </svg>
                </div>
                <div class="activity-content">
                  <div class="activity-title">Amina Zahra a postul√© √† "D√©veloppeur Front-end"</div>
                  <div class="activity-meta">12 mai 2023 ‚Ä¢ <span class="badge accept">Accept√©e</span></div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17,21 17,13 7,13 7,21"></polyline>
                    <polyline points="7,3 7,8 15,8"></polyline>
                  </svg>
                </div>
                <div class="activity-content">
                  <div class="activity-title">Said Corp a publi√© une nouvelle offre</div>
                  <div class="activity-meta">11 mai 2023 ‚Ä¢ <span class="badge pending">En attente</span></div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="8.5" cy="7" r="4"></circle>
                    <polyline points="17,11 19,13 23,9"></polyline>
                  </svg>
                </div>
                <div class="activity-content">
                  <div class="activity-title">Karim Tech a cr√©√© un compte entreprise</div>
                  <div class="activity-meta">10 mai 2023 ‚Ä¢ <span class="badge accept">Activ√©</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="panel-users" class="panel" style="display:none">
          <div class="card">
            <div class="section-title">Gestion des utilisateurs</div>
            <table class="table" id="usersTable">
              <thead>
                <tr>
                  <th>Utilisateur</th>
                  <th>Contact</th>
                  <th>Role</th>
                  <th>Statut</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div id="panel-offers" class="panel" style="display:none">
          <div class="card">
            <div class="section-title">Offres d'emploi</div>
            <table class="table" id="offersTable">
              <thead>
                <tr>
                  <th>Entreprise</th>
                  <th>Poste</th>
                  <th>Comp√©tences</th>
                  <th>Statut</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div id="panel-analytics" class="panel" style="display:none">
          <div class="card">
            <div class="section-title">Analytics & Rapports</div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">
                  <svg class="icon-candidate" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg>
                </div>
                <div class="stat-content">
                  <div class="stat-label">Candidats inscrits</div>
                  <div class="stat-value" id="analyticsCandidates">0</div>
                  <div class="trend up">‚Üë +12% ce mois</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">
                  <svg class="icon-company" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17,21 17,13 7,13 7,21"></polyline>
                    <polyline points="7,3 7,8 15,8"></polyline>
                  </svg>
                </div>
                <div class="stat-content">
                  <div class="stat-label">Entreprises</div>
                  <div class="stat-value" id="analyticsCompanies">0</div>
                  <div class="trend up">‚Üë +5% ce mois</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">
                  <svg class="icon-offer" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10,9 9,9 8,9"></polyline>
                  </svg>
                </div>
                <div class="stat-content">
                  <div class="stat-label">Offres publi√©es</div>
                  <div class="stat-value" id="analyticsOffers">0</div>
                  <div class="trend up">‚Üë +8% ce mois</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">
                  <svg class="icon-match" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22,4 12,14.01 9,11.01"></polyline>
                  </svg>
                </div>
                <div class="stat-content">
                  <div class="stat-label">Matchings r√©ussis</div>
                  <div class="stat-value" id="analyticsMatches">0%</div>
                  <div class="trend up">‚Üë +3% ce mois</div>
                </div>
              </div>
            </div>
            
            <div style="margin-top:32px">
              <div class="section-title">Diagrammes Statistiques</div>
              <div class="charts-container">
                <!-- Diagramme 1: R√©partition des Utilisateurs -->
                <div class="chart-card">
                  <div class="chart-title">R√©partition des Utilisateurs</div>
                  <div class="chart-container">
                    <canvas id="analyticsUserDistributionChart"></canvas>
                  </div>
                </div>
                
                <!-- Diagramme 2: Statut des Offres -->
                <div class="chart-card">
                  <div class="chart-title">Statut des Offres</div>
                  <div class="chart-container">
                    <canvas id="offerStatusChart"></canvas>
                  </div>
                </div>
                
                <!-- Diagramme 3: √âvolution des Matchings -->
                <div class="chart-card">
                  <div class="chart-title">√âvolution des Matchings</div>
                  <div class="chart-container">
                    <canvas id="matchingTrendChart"></canvas>
                  </div>
                </div>
                
                <!-- Diagramme 4: Activit√© Mensuelle -->
                <div class="chart-card">
                  <div class="chart-title">Activit√© Mensuelle</div>
                  <div class="chart-container">
                    <canvas id="analyticsMonthlyActivityChart"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="modal" class="modal-backdrop">
    <div class="modal" role="dialog">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong id="modalTitle" style="font-size:20px">D√©tails</strong>
        <button class="btn secondary" onclick="closeModal()">
          <svg class="icon-delete" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
          Fermer
        </button>
      </div>
      <div id="modalBody" style="margin-top:20px"></div>
    </div>
  </div>

  <script>
    const users = [
      {id:1,name:'Amina Zahra',email:'amina@example.com',role:'candidat',active:true},
      {id:2,name:'Said Corp',email:'said.hr@example.com',role:'entreprise',active:true},
      {id:3,name:'Hassan Admin',email:'hassan@example.com',role:'admin',active:true},
      {id:4,name:'Karim Tech',email:'karim@tech.com',role:'entreprise',active:true},
      {id:5,name:'Fatima Ben',email:'fatima.b@example.com',role:'candidat',active:false}
    ];
    const offers = [
      {id:1,company:'Said Corp',title:'D√©veloppeur Front-end',tags:['javascript','react','vue'],status:'published'},
      {id:2,company:'Acme SARL',title:'Data Scientist',tags:['python','ml','ai'],status:'pending'},
      {id:3,company:'Karim Tech',title:'DevOps Engineer',tags:['aws','docker','kubernetes'],status:'published'},
      {id:4,company:'WebSolutions',title:'UX/UI Designer',tags:['figma','sketch','adobe xd'],status:'published'}
    ];
    let currentPanel = 'dashboard';
    let userDistributionChart, monthlyActivityChart, analyticsUserDistributionChart, offerStatusChart, matchingTrendChart, analyticsMonthlyActivityChart;

    function $(id){return document.getElementById(id)}
    
    function showPanel(panel){
      currentPanel = panel;
      
      // Update active nav button
      document.querySelectorAll('.nav button').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Update panel title
      const titles = {
        'dashboard': 'Dashboard',
        'users': 'Utilisateurs',
        'offers': 'Offres',
        'analytics': 'Analytics'
      };
      
      $('panelTitle').innerText = titles[panel] || panel;
      
      // Show/hide panels
      ['dashboard','users','offers','analytics'].forEach(p=>{
        $('panel-'+p).style.display = (p===panel)?'block':'none';
      });
      renderCurrent();
    }

    function renderCurrent(){ 
      renderCounts(); 
      renderUsers(); 
      renderOffers(); 
      
      // Ne rendre les diagrammes que si le panel Analytics est visible
      if (currentPanel === 'analytics') {
        renderAnalytics(); 
      }
    }

    function renderCounts(){
      $('countCandidates').innerText = users.filter(u=>u.role==='candidat').length;
      $('countCompanies').innerText = users.filter(u=>u.role==='entreprise').length;
      $('countOffers').innerText = offers.length;
      $('matchRate').innerText = Math.round(Math.random()*20 + 70)+'%';
      
      // Initialiser les diagrammes du dashboard
      initDashboardCharts();
    }

    function initDashboardCharts() {
      // Diagramme de r√©partition des utilisateurs
      const userDistributionCtx = document.getElementById('userDistributionChart').getContext('2d');
      if (userDistributionChart) {
        userDistributionChart.destroy();
      }
      userDistributionChart = new Chart(userDistributionCtx, {
        type: 'doughnut',
        data: {
          labels: ['Candidats', 'Recruteurs', 'Entreprises', 'Administrateurs'],
          datasets: [{
            data: [45, 30, 20, 5],
            backgroundColor: [
              '#4a6cf7',
              '#6c8aff',
              '#fd79a8',
              '#00b894'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                padding: 20,
                usePointStyle: true
              }
            }
          }
        }
      });

      // Diagramme d'activit√© mensuelle
      const monthlyActivityCtx = document.getElementById('monthlyActivityChart').getContext('2d');
      if (monthlyActivityChart) {
        monthlyActivityChart.destroy();
      }
      monthlyActivityChart = new Chart(monthlyActivityCtx, {
        type: 'line',
        data: {
          labels: ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Ao√ªt', 'Sep', 'Oct', 'Nov', 'D√©c'],
          datasets: [{
            label: 'Matchings',
            data: [120, 150, 180, 200, 240, 280, 320, 300, 350, 380, 400, 420],
            borderColor: '#4a6cf7',
            backgroundColor: 'rgba(74, 108, 247, 0.1)',
            tension: 0.4,
            fill: true
          }, {
            label: 'Nouvelles offres',
            data: [80, 100, 120, 140, 160, 190, 210, 200, 220, 240, 260, 280],
            borderColor: '#00b894',
            backgroundColor: 'rgba(0, 184, 148, 0.1)',
            tension: 0.4,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                padding: 20
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    function renderUsers(){
      const tbody = document.querySelector('#usersTable tbody');
      const q = $('globalSearch').value.toLowerCase();
      tbody.innerHTML='';
      users.filter(u=> (u.name+u.email+u.role).toLowerCase().includes(q)).forEach(u=>{
        const tr=document.createElement('tr'); 
        tr.innerHTML=
        `<td>
          <div style="display:flex;align-items:center;gap:12px">
            <div class="profile-avatar">${u.name.charAt(0)}</div>
            <div>
              <strong>${u.name}</strong>
              <div class="small">ID: ${u.id}</div>
            </div>
          </div>
         </td>
         <td>${u.email}</td>
         <td><span class="tag">${u.role}</span></td>
         <td>${u.active?'<span class="badge accept">Actif</span>':'<span class="badge pending">Suspendu</span>'}</td>
         <td class="action-buttons">
            <button class="btn secondary" onclick="viewUser(${u.id})">
              <svg class="icon-view" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
              Voir
            </button>
            <button class="btn" onclick="toggleSuspend(${u.id})">${u.active?'Suspendre':'R√©activer'}</button>
         </td>`;
        tbody.appendChild(tr);
      })
    }

    function viewUser(id){
      const u = users.find(x=>x.id===id);
      showModal('D√©tails Utilisateur', `
        <div style="display:flex;gap:20px;align-items:flex-start;margin-bottom:20px">
          <div class="profile-avatar" style="width:80px;height:80px;font-size:32px">${u.name.charAt(0)}</div>
          <div>
            <strong style="font-size:20px">${u.name}</strong>
            <div class="small" style="margin-top:8px">${u.email}</div>
            <div style="margin-top:12px"><span class="tag">${u.role}</span></div>
          </div>
        </div>
        <div style="background:var(--hover-bg);padding:16px;border-radius:12px">
          <div class="small">Statut du compte: <strong>${u.active ? 'Actif' : 'Suspendu'}</strong></div>
          <div class="small" style="margin-top:8px">Derni√®re connexion: 12 mai 2023</div>
          <div class="small" style="margin-top:8px">Date d'inscription: 15 mars 2023</div>
        </div>
      `);
    }

    function toggleSuspend(id){
      const u=users.find(x=>x.id===id); 
      u.active=!u.active;
      renderCurrent();
      showModal(u.active ? "Compte r√©activ√©" : "Compte suspendu", 
                `<div>L'utilisateur <strong>${u.name}</strong> a √©t√© ${u.active ? 'r√©activ√©' : 'suspendu'} avec succ√®s.</div>`);
      setTimeout(() => closeModal(), 1500);
    }

    function renderOffers(){
      const tbody=document.querySelector('#offersTable tbody');
      const q = $('globalSearch').value.toLowerCase();
      tbody.innerHTML='';
      offers.filter(o=> (o.title+o.company+(o.tags||[]).join(' ')).toLowerCase().includes(q)).forEach(o=>{
        const tr=document.createElement('tr');
        const statusBadge = o.status === 'published' ? 
          '<span class="badge published">Publi√©e</span>' : 
          '<span class="badge pending">En attente</span>';
          
        const tagsHTML = o.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
        
        tr.innerHTML=
          `<td><strong>${o.company}</strong></td>
           <td>${o.title}</td>
           <td>${tagsHTML}</td>
           <td>${statusBadge}</td>
           <td class="action-buttons">
              <button class='btn secondary' onclick='viewOffer(${o.id})'>
                <svg class="icon-view" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
                Voir
              </button>
              <button class='btn danger' onclick='deleteOffer(${o.id})'>
                <svg class="icon-delete" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3,6 5,6 21,6"></polyline>
                  <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"></path>
                </svg>
                Supprimer
              </button>
           </td>`;
        tbody.appendChild(tr);
      })
    }

    function viewOffer(id){
      const o=offers.find(x=>x.id===id);
      const tagsHTML = o.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
      
      showModal('D√©tails de l\'offre: '+o.title, `
        <div style="margin-bottom:20px">
          <div style="font-size:20px;font-weight:600;margin-bottom:8px">${o.title}</div>
          <div class="small" style="margin-bottom:12px">Publi√©e par <strong>${o.company}</strong></div>
          <div>${tagsHTML}</div>
        </div>
        <div style="background:var(--hover-bg);padding:16px;border-radius:12px">
          <div class="small">Statut: <strong>${o.status === 'published' ? 'Publi√©e' : 'En attente de validation'}</strong></div>
          <div class="small" style="margin-top:8px">Date de publication: 10 mai 2023</div>
          <div class="small" style="margin-top:8px">Nombre de candidatures: ${Math.floor(Math.random() * 20) + 5}</div>
          <div class="small" style="margin-top:8px">Vues: ${Math.floor(Math.random() * 100) + 30}</div>
        </div>
      `);
    }

    function deleteOffer(id){
      if(!confirm("Voulez-vous vraiment supprimer cette offre ?")) return;
      const index = offers.findIndex(o => o.id === id);
      if(index !== -1){
        const deletedOffer = offers[index];
        offers.splice(index, 1);
        renderCurrent();
        showModal("Suppression r√©ussie", `<div>L'offre <strong>${deletedOffer.title}</strong> a √©t√© supprim√©e avec succ√®s.</div>`);
        setTimeout(() => closeModal(), 1500);
      }
    }

    function renderAnalytics(){
      const candidates = users.filter(u=>u.role==='candidat').length;
      const companies = users.filter(u=>u.role==='entreprise').length;
      const admins = users.filter(u=>u.role==='admin').length;
      const publishedOffers = offers.filter(o=>o.status==='published').length;
      const pendingOffers = offers.filter(o=>o.status==='pending').length;
      const expiredOffers = Math.floor(offers.length * 0.125);
      const draftOffers = Math.floor(offers.length * 0.125);
      
      $('analyticsCandidates').innerText = candidates;
      $('analyticsCompanies').innerText = companies;
      $('analyticsOffers').innerText = publishedOffers + pendingOffers;
      $('analyticsMatches').innerText = Math.round(Math.random()*20 + 70)+'%';
      
      // Diagramme 1: R√©partition des Utilisateurs
      const analyticsUserDistributionCtx = document.getElementById('analyticsUserDistributionChart').getContext('2d');
      if (analyticsUserDistributionChart) {
        analyticsUserDistributionChart.destroy();
      }
      analyticsUserDistributionChart = new Chart(analyticsUserDistributionCtx, {
        type: 'pie',
        data: {
          labels: ['Candidats', 'Entreprises', 'Administrateurs'],
          datasets: [{
            data: [candidates, companies, admins],
            backgroundColor: [
              '#4a6cf7',
              '#10b981',
              '#f59e0b'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
      
      // Diagramme 2: Statut des Offres
      const offerStatusCtx = document.getElementById('offerStatusChart').getContext('2d');
      if (offerStatusChart) {
        offerStatusChart.destroy();
      }
      offerStatusChart = new Chart(offerStatusCtx, {
        type: 'doughnut',
        data: {
          labels: ['Publi√©es', 'En attente', 'Expir√©es', 'Brouillons'],
          datasets: [{
            data: [publishedOffers, pendingOffers, expiredOffers, draftOffers],
            backgroundColor: [
              '#10b981',
              '#f59e0b',
              '#ef4444',
              '#6b7280'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
      
      // Diagramme 3: √âvolution des Matchings
      const matchingTrendCtx = document.getElementById('matchingTrendChart').getContext('2d');
      if (matchingTrendChart) {
        matchingTrendChart.destroy();
      }
      matchingTrendChart = new Chart(matchingTrendCtx, {
        type: 'line',
        data: {
          labels: ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Ao√ªt', 'Sep', 'Oct', 'Nov', 'D√©c'],
          datasets: [{
            label: 'Taux de matching (%)',
            data: [65, 68, 72, 70, 75, 78, 82, 85, 80, 83, 87, 90],
            borderColor: '#4a6cf7',
            backgroundColor: 'rgba(74, 108, 247, 0.1)',
            tension: 0.4,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              min: 50,
              max: 100
            }
          }
        }
      });
      
      // Diagramme 4: Activit√© Mensuelle
      const analyticsMonthlyActivityCtx = document.getElementById('analyticsMonthlyActivityChart').getContext('2d');
      if (analyticsMonthlyActivityChart) {
        analyticsMonthlyActivityChart.destroy();
      }
      analyticsMonthlyActivityChart = new Chart(analyticsMonthlyActivityCtx, {
        type: 'bar',
        data: {
          labels: ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Juin'],
          datasets: [
            {
              label: 'Inscriptions',
              data: [45, 52, 48, 65, 72, 68],
              backgroundColor: '#4a6cf7'
            },
            {
              label: 'Offres cr√©√©es',
              data: [30, 35, 28, 45, 50, 42],
              backgroundColor: '#10b981'
            },
            {
              label: 'Matchings',
              data: [20, 25, 18, 35, 40, 32],
              backgroundColor: '#f59e0b'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    function showModal(title,html){ 
      $('modal').style.display='flex'; 
      $('modalTitle').innerText=title; 
      $('modalBody').innerHTML=html; 
    }
    
    function closeModal(){ 
      $('modal').style.display='none'; 
    }
    
    function toggleTheme(){ 
      const app = $('app'); 
      app.setAttribute('data-theme', app.getAttribute('data-theme')==='light'?'dark':'light'); 
    }

    // Initialize the dashboard
    renderCurrent();
  </script>
</body>
</html>